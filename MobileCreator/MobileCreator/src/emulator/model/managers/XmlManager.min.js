define(["require","exports","utils/log/Log","emulator/model/Page","emulator/model/ui/TextView","emulator/model/ui/Button","emulator/model/ui/Input","emulator/model/ui/ImageView","emulator/model/ui/WebView","emulator/model/ui/LinearLayout","emulator/model/attributes/LinearLayoutTag","emulator/model/attributes/ControlTag","emulator/model/attributes/TextViewTag","emulator/model/attributes/ButtonTag","emulator/model/attributes/InputTag","emulator/model/attributes/ImageViewTag","emulator/model/attributes/WebViewTag"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var d=i,g=r,nt=u,tt=f,it=e,rt=o,ut=s,ft=h,k=c,b=l,et=a,ot=v,st=y,ht=p,ct=w,lt=function(){function n(){this.logger=new d.Logger("XmlManager"),this.logger.log("in constructor")}return n.App="application",n.Forms="forms",n.Form="form",n.FormName="form_name",n.LinearLayout="LinearLayout",n.TextView="TextView",n.EditText="EditText",n.Button="Button",n.ImageView="ImageView",n.WebView="WebView",n.Logic="logic",n.Trigger="trigger",n.FormId="form-id",n.Event="event",n.prototype.parsePage=function(n){this.logger.log("parse page: "+n);var t=new XMLHttpRequest,i;try{t.open("GET",n,!1),t.send(null),i=t.responseXML}catch(r){return window.alert("Unable to load the requested file."),undefined}return this.parseNode(i.firstChild)},n.prototype.parseXmlString=function(n){this.logger.log("parseXmlString");var t=new DOMParser,i=t.parseFromString(n,"text/xml");return this.parseApplication(i.firstChild)},n.prototype.parseApplication=function(t){var i,r,u;for(this.logger.log("parseApplication: "+t.nodeName),i=0;i<t.childNodes.length;i++){r=t.childNodes.item(i);switch(r.nodeName){case n.Forms:u=this.parseForms(r);break;case n.Logic:this.parseLogic(r)}}return u},n.prototype.parseForms=function(t){for(var r=[],i=0;i<t.childNodes.length;i++)t.childNodes.item(i).nodeName==n.Form&&r.push(this.parseForm(t.childNodes.item(i)));return r},n.prototype.parseLogic=function(){},n.prototype.parseForm=function(n){this.logger.log("parseForm: "+n.nodeName);var t=n.attributes.form_name.value,i=this.parseNode(n.childNodes.item(1));return new g.Page(t,i)},n.prototype.parseNode=function(t){this.logger.log("parse node: "+t.nodeName);var i;switch(t.nodeName){case n.LinearLayout:i=this.parseLinearLayout(t);break;case n.TextView:i=this.parseTextView(t);break;case n.Button:i=this.parseButton(t);break;case n.ImageView:i=this.parseImageView(t);break;case n.WebView:i=this.parseWebView(t)}return i},n.prototype.parseLinearLayout=function(n){var i,r,u,t,f;for(this.logger.log("parseLinearLayout"),i=new k.LinearLayoutTag,this.fillLinearLayoutData(n,i),r=new ft.LinearLayout(i),u=n.childNodes.length,this.logger.log("parseLinearLayout length: "+u),t=0;t<u;t++)f=this.parseNode(n.childNodes.item(t)),f&&r.addChild(f);return r},n.prototype.parseTextView=function(n){var t;return this.logger.log("parseTextView"),t=new et.TextViewTag,this.fillTextViewData(n,t),new nt.TextView(t)},n.prototype.parseInput=function(n){var t;return this.logger.log("parseInput"),t=new st.InputTag,this.fillInputData(n,t),new it.Input(t)},n.prototype.parseButton=function(n){var t;return this.logger.log("parseButton"),t=new ot.ButtonTag,this.fillButtonData(n,t),new tt.Button(t)},n.prototype.parseImageView=function(n){var t;return this.logger.log("parseImageView"),t=new ht.ImageViewTag,this.fillImageViewData(n,t),new rt.ImageView(t)},n.prototype.parseWebView=function(n){var t;return this.logger.log("parseWebView"),t=new ct.WebViewTag,this.fillWebViewData(n,t),new ut.WebView(t)},n.prototype.fillLinearLayoutData=function(n,t){this.fillControlPanelData(n,t);var i=n.attributes.orientation;i&&(this.logger.log("orientation: "+i.value),t.Orientation=i.value=="vertical"?k.LinearLayoutTag.Vertical:k.LinearLayoutTag.Horizontal)},n.prototype.fillTextViewData=function(n,t){var i,r;this.fillControlTagData(n,t),i=n.attributes.text,i&&(this.logger.log("text: "+i.value),t.Text=i.value),r=n.attributes.textSize,r&&(this.logger.log("textSize: "+r.value),t.TextSize=parseInt(r.value))},n.prototype.fillInputData=function(n,t){this.fillTextViewData(n,t)},n.prototype.fillButtonData=function(n,t){this.fillTextViewData(n,t);var i=n.attributes.onClick;i&&(this.logger.log("onClick: "+i.value),t.OnClick=i.value)},n.prototype.fillImageViewData=function(n,t){this.fillControlTagData(n,t);var i=n.attributes.src;i&&(this.logger.log("src: "+i.value),t.ImageUrl=i.value)},n.prototype.fillWebViewData=function(n,t){this.fillControlTagData(n,t);var i=n.attributes.url;i&&(this.logger.log("url: "+i.value),t.Url=i.value)},n.prototype.fillControlPanelData=function(n,t){this.fillControlTagData(n,t)},n.prototype.fillControlTagData=function(n,t){var c=n.attributes.id,i,r,u,f,e,o,s,h;if(c&&(this.logger.log("id: "+c.value),t.Id=c.value),i=n.attributes.layout_width,i){this.logger.log("layout_width: "+i.value);switch(i.value){case"wrap_content":t.Width=b.ControlTag.WrapContent;break;case"fill_parent":t.Width=b.ControlTag.MatchParrent;break;default:t.Width=parseInt(i.value)}}if(r=n.attributes.layout_height,r){this.logger.log("layout_height: "+r.value);switch(r.value){case"wrap_content":t.Height=b.ControlTag.WrapContent;break;case"fill_parent":t.Height=b.ControlTag.MatchParrent;break;default:t.Height=parseInt(r.value)}}u=n.attributes.background,u&&(this.logger.log("background: "+u.value),t.Background=u.value),f=n.attributes.gravity,f&&(this.logger.log("gravity: "+f.value),t.Gravity=f.value),e=n.attributes.layout_marginTop,e&&(this.logger.log("layout_marginTop: "+e.value),t.MarginTop=parseInt(e.value)),o=n.attributes.layout_marginBottom,o&&(this.logger.log("layout_marginBottom: "+o.value),t.MarginBottom=parseInt(o.value)),s=n.attributes.layout_marginLeft,s&&(this.logger.log("layout_marginLeft: "+s.value),t.MarginLeft=parseInt(s.value)),h=n.attributes.layout_marginRight,h&&(this.logger.log("layout_marginRight: "+h.value),t.MarginRight=parseInt(h.value))},n}();t.XmlManager=lt})