<?xml version='1.0' encoding='utf-8'?>
<root>
    <world>
        <walls/>
        <colorFields/>
        <regions/>
    </world>
    <robots>
        <robot direction="0" position="-206:26" id="trikV62KitRobot">
            <sensors>
                <sensor direction="0" port="E3###input###M3###encoder3" position="0:0" type=""/>
                <sensor direction="0" port="M4###output######" position="0:0" type=""/>
                <sensor direction="0" port="E2###input###M2###encoder2" position="0:0" type=""/>
                <sensor direction="0" port="E4###input###M4###encoder4" position="0:0" type=""/>
                <sensor direction="0" port="E1###input###M1###encoder1" position="0:0" type=""/>
                <sensor direction="0" port="M3###output######" position="0:0" type=""/>
                <sensor direction="0" port="A1###input######sensorA1" position="0:0" type=""/>
            </sensors>
            <startPosition y="51" direction="0" x="-181"/>
            <wheels left="M3###output######" right="M4###output######"/>
        </robot>
    </robots>
    <constraints>
        <timelimit value="20000"/>
        <!-- событие, сообщающее об успехе через 15 секунд после начала (т.к. нет другого условия выполнения задания) -->
        <event settedUpInitially="true">
            <condition>
                <timer timeout="15000"/>
            </condition>
            <trigger>
                <success/>
            </trigger>
        </event>
        <!-- событие, которое проверяет, что нарисован только один эллипс, инициализирует переменные начальными значениями -->
        <event id="Single_ellipse" settedUpInitially="true">
            <conditions glue="and">
                <equals>
                    <objectState object="robot1.display.ellipses.size"/>
                    <int value="1"/>
                </equals>
                <equals>
                    <objectState object="robot1.display.objects.size"/>
                    <int value="1"/>
                </equals>
            </conditions>
            <triggers>
                <setter name="x">
                    <objectState object="robot1.display.ellipses.last.center.x"/>
                </setter>
                <setter name="y">
                    <objectState object="robot1.display.ellipses.last.center.y"/>
                </setter>
                <setUp id="Left"/>
                <setUp id="Right"/>
                <setUp id="Up"/>
                <setUp id="Down"/>
            </triggers>
        </event>
        <!-- Событие, которое выдает ошибку, если эллипс не нарисован или нарисованы другие объекты -->
        <event settedUpInitially="true">
            <conditions glue="and">
                <timer forceDropOnTimeout="true" timeout="100"/>
                <settedUp id="Single_ellipse"/>
            </conditions>
            <trigger>
                <fail message="На экране должен быть один эллипс"/>
            </trigger>
        </event>
        <!-- событие, которое срабатывает, когда пользователь нажимает кнопку "влево", возводит события, проверяющие результат -->
        <event id="Left">
            <condition>
                <equals>
                    <objectState object="robot1.Left.value"/>
                    <int value="1"/>
                </equals>
            </condition>
            <triggers>
                <setUp id="Left_checking"/>
                <setUp id="Left_fails"/>
            </triggers>
        </event>
        <!-- событие, которое проверяет, что эллипс сдвинулся влево -->
        <event id="Left_checking">
            <conditions glue="and">
                <timer timeout="100"/>
                <less>
                    <objectState object="robot1.display.ellipses.last.center.x"/>
                    <variableValue name="x"/>
                </less>
            </conditions>
            <trigger>
                <setter name="x">
                    <objectState object="robot1.display.ellipses.last.center.x"/>
                </setter>
            </trigger>
        </event>
        <!-- Событие, которое сообщает об ошибке, если эллипс сдвинулся не туда или вообще не сдвинулся -->
        <event id="Left_fails">
            <conditions glue="and">
                <timer forceDropOnTimeout="true" timeout="200"/>
                <settedUp id="Left_checking"/>
            </conditions>
            <trigger>
                <fail message="При нажатии на кнопку влево эллипс либо не сдвинулся влево, либо вообще не сдвинулся"/>
            </trigger>
        </event>
        <!-- событие, которое срабатывает, когда пользователь нажимает кнопку "вправо", возводит события, проверяющие результат -->
        <event id="Right">
            <condition>
                <equals>
                    <objectState object="robot1.Right.value"/>
                    <int value="1"/>
                </equals>
            </condition>
            <triggers>
                <setUp id="Right_checking"/>
                <setUp id="Right_fails"/>
            </triggers>
        </event>
        <!-- событие, которое проверяет, что эллипс сдвинулся вправо -->
        <event id="Right_checking">
            <conditions glue="and">
                <timer timeout="100"/>
                <greater>
                    <objectState object="robot1.display.ellipses.last.center.x"/>
                    <variableValue name="x"/>
                </greater>
            </conditions>
            <trigger>
                <setter name="x">
                    <objectState object="robot1.display.ellipses.last.center.x"/>
                </setter>
            </trigger>
        </event>
        <!-- Событие, которое сообщает об ошибке, если эллипс сдвинулся не туда или вообще не сдвинулся -->
        <event id="Right_fails">
            <conditions glue="and">
                <timer forceDropOnTimeout="true" timeout="200"/>
                <settedUp id="Right_checking"/>
            </conditions>
            <trigger>
                <fail message="При нажатии на кнопку вправо эллипс либо не сдвинулся вправо, либо вообще не сдвинулся"/>
            </trigger>
        </event>
        <!-- событие, которое срабатывает, когда пользователь нажимает кнопку "вверх", возводит события, проверяющие результат -->
        <event id="Up">
            <condition>
                <equals>
                    <objectState object="robot1.Up.value"/>
                    <int value="1"/>
                </equals>
            </condition>
            <triggers>
                <setUp id="Up_checking"/>
                <setUp id="Up_fails"/>
            </triggers>
        </event>
        <!-- событие, которое проверяет, что эллипс сдвинулся вверх -->
        <event id="Up_checking">
            <conditions glue="and">
                <timer timeout="100"/>
                <less>
                    <objectState object="robot1.display.ellipses.last.center.y"/>
                    <variableValue name="y"/>
                </less>
            </conditions>
            <trigger>
                <setter name="y">
                    <objectState object="robot1.display.ellipses.last.center.y"/>
                </setter>
            </trigger>
        </event>
        <!-- Событие, которое сообщает об ошибке, если эллипс сдвинулся не туда или вообще не сдвинулся -->
        <event id="Up_fails">
            <conditions glue="and">
                <timer forceDropOnTimeout="true" timeout="200"/>
                <settedUp id="Up_checking"/>
            </conditions>
            <trigger>
                <fail message="При нажатии на кнопку вверх эллипс либо не сдвинулся вверх, либо вообще не сдвинулся"/>
            </trigger>
        </event>
        <!-- событие, которое срабатывает, когда пользователь нажимает кнопку "вниз", возводит события, проверяющие результат -->
        <event id="Down">
            <condition>
                <equals>
                    <objectState object="robot1.Down.value"/>
                    <int value="1"/>
                </equals>
            </condition>
            <triggers>
                <setUp id="Down_checking"/>
                <setUp id="Down_fails"/>
            </triggers>
        </event>
        <!-- событие, которое проверяет, что эллипс сдвинулся вниз -->
        <event id="Down_checking">
            <conditions glue="and">
                <timer timeout="100"/>
                <greater>
                    <objectState object="robot1.display.ellipses.last.center.y"/>
                    <variableValue name="y"/>
                </greater>
            </conditions>
            <trigger>
                <setter name="y">
                    <objectState object="robot1.display.ellipses.last.center.y"/>
                </setter>
            </trigger>
        </event>
        <!-- Событие, которое сообщает об ошибке, если эллипс сдвинулся не туда или вообще не сдвинулся -->
        <event id="Down_fails">
            <conditions glue="and">
                <timer forceDropOnTimeout="true" timeout="200"/>
                <settedUp id="Down_checking"/>
            </conditions>
            <trigger>
                <fail message="При нажатии на кнопку вниз эллипс либо не сдвинулся вниз, либо вообще не сдвинулся"/>
            </trigger>
        </event>
    </constraints>
</root>
